## 유니캐스트
<img src="https://user-images.githubusercontent.com/37951612/78056938-de607580-73c0-11ea-8d45-1327e0110cbd.png" width="300" height="200">

**1:1로 데이터를 전달하는 통신 방식**

1. Source의 MAC Address를 적고, Destination의 MAC Address도 적고 프레임에 감싸서 데이터를 전달한다.
2. 로컬 네트워크 환경은 일반적으로 Shared한 통신 방식을 취하기 때문에, 일단 같은 네트워크 서식지의 모든 PC는 프레임을 받는다.
3. 각각의 PC는 Source의 MAC Address와 자신의 LAN카드 MAC Address를 비교하여 만약 서로 다르다면 프레임을 CPU에 보내지 않고 폐기처분한다. 만약 MAC Address가 같다면, PC는 CPU 위에 프레임을 올린다.

## 브로드캐스트
<img src="https://user-images.githubusercontent.com/37951612/78056944-e0c2cf80-73c0-11ea-88ee-4c1e8c415cb3.png" width="300" height="200">

**같은 네트워크 서식지에 있는 모든 PC에 데이터를 주는 방식**  
즉, 패킷이나 프레임을 받는 PC의 MAC Address가 실제 프레임에 적힌 MAC Address와 일치하지 않아도 폐기하지 않고, CPU에 Interrupt를 건 후 우선적으로 받은 패킷을 처리하게 한다. 즉, 자신의 LAN카드 MAC Address와 일치하지 않는 패킷을 받더라도 PC는 CPU에게 그 패킷을 처리하게 시킨다(모든 프레임을 다 CPU에 올리기 때문에 PC 성능이 떨어진다).  
따라서 너무 많은 브로드캐스트는 같은 서식지의 네트워크에 많은 노드를 발생시켜 혼잡을 야기하며, 그 안에 거주하는 PC의 성능을 저하시킬 수 있다.

> 앞의 글만 읽어봐서는 단점이 많아보이는데, 왜 브로드캐스트를 이용할까?  
  만약 Destination PC의 MAC Address는 모르고 IP 주소만 알고있을 때, Destination PC의 MAC Address를 알기 위해 브로드캐스트를 알린다. 즉, 네트워크 안에서 **"여기 이런 IP주소 가진 PC 있으면 알려줘!"** 라고 외친다. 그럼 해당 PC의 MAC Address를 전달받을 수 있다.  
  IP 주소를 MAC 주소로 바꾸는 과정, 얻어내는 과정을 **ARP(Address Resolution Protocol)**이라고 하며, 그 외에도 서버가 다수의 클라이언트에게 서비스하기 위해 브로드캐스트를 사용하기도 한다.

## 멀티캐스트
<img src="https://user-images.githubusercontent.com/37951612/78057046-0ea81400-73c1-11ea-9298-54d41ba9cb70.png" width="300" height="200">

ex) 사용자 200명 있는 네트워크에서 150명에게만 데이터를 주고 싶을 때

**특정 그룹에게 데이터를 보내는 방식**

유니캐스트로 150명에게 각각 150번 보낼 수 있고, 브로드캐스트로 모든 사용자에게 데이터를 보낼 수도 있겠지만, 모두 서버 오버헤드가 커지는 방법이다. 따라서 멀티캐스트를 사용해야 하며, 멀티캐스트는 라우터와 스위치가 멀티캐스트 지원을 해줘야 가능하다(지원 안하면 브로드캐스트 방식처럼 작동한다 => 라우터는 브로드캐스트를 막고, 스위치는 모든 포트에 데이터를 뿌린다).  

D Class 주소 체계에서만 유효하고 라우터 및 스위치가 멀티캐스트를 지원해야만 사용할 수 있는 것이 단점이다.


# NAT & NAPT
사설 IP(Private IP)를 공인 IP(Public IP)로 변환하는 기술이다

> 현재 사용하는 IP 주소는 4 옥텟으로 표현한다. 여기서 옥텟이란 8개의 연속적인 비트 집합을 의미하는 것으로, byte와 같은 단위라고 할 수 있다. 즉, IPv4에서의 주소는 4byte로 표현하고, 최대 개수는 2^32= 약 43억 개다. 이는 별로 많은 개수가 아니다. 그래서 IP 주소 절약을 위해 NAT을 도입하였다.

> NAT은 하나의 공인 IP를 여러 개의 사설 IP로 변환하는 시스템이다. 랜카드를 두 개 이상 가진 공유기(라우터)가 사설망과 외부망 사이의 중개자 역할을 하는 것이다. ex) 공유기

## NAT (Network Address Translation)
- 사설 IP 주소가 할당된 클라이언트가 인터넷 상의 어떤 서버에 접근할 때, NAT 라우터는 클라이언트의 IP를 NAT가 가지고 있는 공인 IP로 변환하여 패킷을 전송한다.
- 서버에서 클라이언트로 전송 시에는 NAT의 공인 IP 주소로 전송하고 이를 받은 NAT 라우터가 클라이언트의 사설 IP 주소로 변환하여 전송한다.
- 사설 IP 주소와 공인 IP 주소가 1:1 변환을 하기 때문에 동시에 여러 클라이언트가 접근할 수 없다.
- 출발지, 목적지 주소 중 어느 한쪽만 변환할 수도 있고, 모두 변환할 수도 있는데, 예를 들어 출발지 IP 주소 또는 Port만 변환하는 NAT를 Source NAT 혹는 SNAT이라고 한다.

### NAT의 장점
- IP 주소 절약
- 보안  
  특별한 설정을 하지 않는 한 외부망에서 사설망 내부 PC로 접근하는 것이 불가능하기 때문에 네트워크를 통한 공격에 매우 안전해진다.

### NAT의 통신 원리
사설망에서 외부망으로 통신을 시도하면 해당 패킷은 무조건 공유기를 거치게 되어 있다. 여기서는 의미상 게이트웨이라고 하겠다. 당연하게도 처음 발신자가 게이트웨이에게 패킷을 전달했을 때 '보내는 사람의 IP'를 나타내는 SRC_IP는 사설망 내부의 발신자 주소로 채워져 있다. 하지만 만약에 이것이 그대로 전달될 경우, 수신자가 응답하는 상대의 주소는 사설망 내부의 IP가 되므로 전 세계의 수많은 사설망중 어디로 보내야 할지 알 수가 없게 된다.  
그래서 게이트웨이는 패킷을 받아서 통신을 위해 패킷 안의 사설IP주소를 자신의 공인IP로 임의수정하여 목적지로 발신한다.  
패킷을 받은 수신자는 목적지 IP 주소에 게이트웨이가 집어넣은 공인IP를 넣어서 패킷을 발신할 것이고, 해당 패킷은 게이트웨이에게 도달하게 될 것이다.  

> 어떻게 이 패킷이 사설망 내부의 특정 사용자에게 도달할 수 있는 것일까?  
게이트웨이가 발신자의 IP를 수정하여 발신할 때 게이트웨이는 내부에 갖고 있는 테이블에 이를 기록해 둔다. 발신 시 Source Address, Destination Address, Protocol 정보를 기록한 후, 응답 패킷이 되돌아오면 그 값을 찾아서 해당하는 사설망 기기에게 발신하는 것이다. 이렇게 테이블을 만들어서 저장해놓고 찾아가는 방법으로 당장은 문제가 해결되지만, 다른 문제가 하나 더 생긴다. 이 때문에 NAPT가 생겼다.

### IP Masquerade (가면)

NAT 내에 속한 기술이다.  

- 예를 들어, 클라이언트 2명이 Router 안에 있는 경우, 클라이언트들은 공인 IP를 가지고 있지 않기 때문에 외부 통신을 할 수 없다. 이것을 보완하기 위해 생긴 것이 IP Masquerade로, 사설 IP 주소를 가진 클라이언트들이 패킷을 전송하면 라우터는 목적지로 패킷을 전송할 때 자신이 보낸 것(사설 IP가 아닌 공인 IP가 출발지인 것)처럼 한다.
- 주소 변환 뿐만 아니라 포트 번호까지 포워딩시켜주는 기능을 갖고 있다. 

## NAPT (Network Address Port Translation)
- 사설 IP 주소를 공인 IP 주소로 변환할 때 사설 IP 주소 별로 다른 포트 번호를 부여한다.  
- 예를 들어 같은 사설 IP 대역을 가진 클라이언트 2명이 동시에 같은 외부망 주소로 통신하려는 경우, NAT는 먼저 통신된 A가 완료된 후 B가 진행된다. (외부망 내의)요청한 곳의 주소, 포트를 보고 해당하는 사설망 주소를 찾아서 보내주어야 하는데 그 주소가 같을 경우 중복되므로 이를 처리할 수 없는 것이다.
  하지만 NAPT는 두 클라이언트에 같은 IP 주소, 다른 포트를 부여함으로써 동시에 여러 클라이언트가 외부 통신이 가능하다. 그리고 Port 정보를 추가로 저장해야하므로 NAT 테이블에서 Port 컬럼만 추가된 것이 NAPT 테이블이다.
  
> 만약 Source Address의 포트 번호까지 같게 패킷이 보내진다면 어떻게 할까?  
  Private Port를 임의의 SRC 포트로 바꿔서 보내면 된다.

---

IP 주소를 좀 더 효율적으로 사용하기 위해 Port도 함께 변환하는 NAPT가 등장하게 되었다. 일반적으로 NAT는 같은 내부 호스트들로부터 시작된 다수의 TCP 세션에 각기 다른 공인 IP가 할당되면 NAT가 보유한 공인 IP가 부족해질 수 있다. 이 때 NAPT를 사용하면 하나의 외부 주소 당 65535개의 구분된 동시적 세션을 유지할 수 있다.  
ex) 가정의 일반 공유기

Port가 중요한 개념이기 때문에 Ping도 불가능하고, FTP(특히 Passive Mode)와 같이 클라이언트와 서버 간 동적 포트변환이 이루어지는 프로토콜의 경우는 이용이 불가능하다.

# Web의 동작 원리

## 사전지식

### IP 주소
컴퓨터들이 인터넷 상에서 서로를 인식하기 위해 지정받은 식별용 번호라고 할 수 있다.  
`IPv4` 주소의 부족으로 `IPv6`가 등장했으며, 128bit로 구성되어 있기 때문에 IP 주소 고갈 염려가 없다는 특징이 있다.

### 도메인 네임 (Domain Name)
IP 주소는 12자리 숫자이기때문에 사람이 외우기 힘들다. 그래서 이 IP 주소를 문자로 표현한 주소를 도메인 네임이라고 한다.  
도메인 네임을 사람의 편의성을 위해 만든 주소이므로 컴퓨터가 이해할 수 있는 IP 주소로 한 번 변환해주어야 한다. 
이 때 사용할 수 있도록 미리 도메인 네임과 그에 해당하는 IP 주소를 한 쌍으로 저장한 DB가 있는데 이것을 **DNS(Domain Name System)** 이라고 한다.

## 작동 방식

![image](https://user-images.githubusercontent.com/37951612/78049435-07c7d400-73b6-11ea-8835-026285fc2592.png)

![image](https://user-images.githubusercontent.com/37951612/78049342-e9fa6f00-73b5-11ea-9b1f-5fae46f246d5.png)

1. 사용자가 브라우저에 URL을 입력한다.
2. 사용자가 입력한 URL 중 **도메인 네임 부분**을 **DNS** 서버에서 검색하고, 
해당 도메인 네임에 대응하는 **IP 주소**를 찾아서 사용자가 입력한 URL 정보와 함께 전달한다.
3. 페이지 URL과 IP 주소는 **HTTP 프로토콜**을 사용하여 **HTTP 요청 메시지**를 생성하고, 
이렇게 생성된 HTTP 요청 메시지는 **TCP 프로토콜**을 사용하여 인터넷을 거쳐 해당 IP 주소의 컴퓨터로 전송된다.
4. 도착지에 도달한 HTTP 요청 메시지는 HTTP 프로토콜을 사용하여 웹 페이지 URL 정보로 변환되어 그에 해당하는 데이터를 검색한다.
5. 검색된 데이터는 다시 HTTP 프로토콜을 사용하여 **HTTP 응답 메시지**를 생성하고, **TCP 프로토콜**을 사용하여 인터넷을 거쳐 요청자의 컴퓨터로 전송된다.
6. 출발지에 도달한 HTTP 응답 메시지는 **HTTP 프로토콜**을 사용하여 웹 페이지로 데이터로 변환되고 웹 브라우저에 출력된다.

# 짧은 지식들 ([link](https://limkydev.tistory.com/))
## 인트라넷(IntraNet)과 익스트라넷(ExtraNet)
- 인트라넷 ex) 사내 메일 시스템, 인사 시스템

  내부 네트워크, 인터넷이나 웹 브라우저같은 기능을 회사 내부 업무에서도 사용하자는 것에 초점이 맞춰져 있다. 특정 사람에게만 사용할 수 있도록 한다.  
  
- 익스트라넷

  인트라넷과 거의 유사하며 인트라넷을 그 기업의 직원 외에도 협력회사, 고객에게 사용할 수 있도록 한 것이다. 
  
## LAN(Local Area Network)과 WAN(Wide Area Network)
- LAN

  Local, 즉 한정된 공간에서 네트워크를 구성한다는 뜻이다.
  
  ex) 한 사무실에 컴퓨터가 30대 있고, 이것으로 네트워크를 구성하면 '사무실에 LAN을 구축한다'고 통상적으로 말한다. 쉽게 근거리 네트워크라고 생각하면 된다.
  
- WAN

  LAN과 대비되는 말로, 멀리 떨어진 곳(지역)까지 서로 연결되는 네트워크를 구성한다는 뜻이다. 인터넷을 이용함으로써 LAN과 WAN이 구분되지 않고 공존할 수 있다.
  
## 이더넷(Ethernet)과 토큰링(TokenRing)
- 이더넷

  이더넷은 **네트워킹(네트워크를 만드는 방법)의 한 방식**이다. 현재 사용하고 있는 네트워킹 방식의 대부분(약 90%)이 이더넷이다. 이더넷의 가장 큰 특징은 `CSMA/CD(Carrier Sense Multiple Access / Collision Detection)` 프로토콜을 사용하는 통신 방식이다.
  
  > CSMA/CD 방식은 통신하고자 하는 컴퓨터가 네트워크를 보고 통신하는 컴퓨터가 없으면(네트워크에 통신이 발생하면 `Carrier`가 발생하고, 이것을 감지하면 누군가가 먼저 데이터를 전송했다는 것을 알 수 있다) 무조건 자신의 데이터를 보내고 잘 도착했는지 확인하는 방식이다.  
  그런데 동시에 두 개 이상의 컴퓨터에서 데이터를 보내려고 하면 충돌이 발생한다. 이 충돌을 탐지하는 것을 `Collision Detection`이라고 하며, 이 충돌은 `Collision`이라고 한다.  
  콜리전이 발생하면 충돌한 PC들은 자신이 보내려던 데이터를 랜덤한 시간동안 대기했다가 다시 전송한다(15 번 이상 실패 시 포기).

- 토큰링

  이제 더이상 사용하지 않는 방식. 토큰링은 네트워킹 방식 중 하나로, 이더넷처럼 자신이 보내고싶을 때 다른 장비가 전송하고 있지 않다면 보내는 방식이 아니라, 오직 토큰을 가진 PC만 네트워크에서 데이터를 보낼 수 있는 방식이다. 보통 하나의 네트워크의 하나의 토큰링이 존재한다.
  
  장점은 콜리전이 발생하지 않으며, 단점은 보내고 싶은 데이터가 있어도 토큰을 갖게 되는 차례가 올 때까지 대기해야하며, 보낼 데이터가 없는 장비에도 의무적으로 토큰이 전달되기 때문에 낭비가 발생한다.
  
  - FDDI 방식
  - ATM 방식

어떤 네트워킹 방식이냐에 따라 랜카드부터 모든 네트워크 장비들을 다르게 구비해야 한다.

## UTP 케이블 ([link](https://comterman.tistory.com/768))

어느 통신장비든지 통신장비끼리 연결해주는 선, 즉 통신케이블이 필요하다. 대표적으로 `UTP(Unshielded Twisted-pair)`가 있다. STP는 보통 UTF보다 성능이 좋고 비싸다. 기존 UTP로 네트워크를 많이 구축했기 때문에 STP는 토큰링 네트워크에 한정적으로 사용된다.

## MAC(Media Access Control) Address
통신을 할 때 서로를 구분할 주소가 필요하다. IP 주소를 말하는 것인가? **IP 주소는 논리적 주소이기 때문에 물리적 주소인 MAC 주소로 결국 변환되어야 한다**(`ARP` 프로토콜에 의해 이루어짐). 

그래서 MAC은? 네트워크에 붙는 각 장비들의 48bit 짜리 주소를 뜻한다. 랜카드 또는 네트워크 장비에 이미 고정되어 있으며, 전 세계적으로 유일한 하드웨어의 주소다. `-`(하이픈), `:`(콜론), `.`(점) 를 구분자로 사용하며, 이 구분자가 다르더라도 모두 같은 MAC Address를 뜻한다.

하지만 2진수로 48bit를 표현한 48자리 MAC Address는 개발자 입장에서 너무 보기 힘들다. 이를 16진수로 표현하면 12진수로 표현할 수 있다. 

MAC Address 앞쪽부터 6자리 값이 벤더, 즉 **생산자**를 나타내는 코드다. 이것을 **OUI(Organizational Unique Identifier)** 라고 하며, 이 코드는 메이커에 따라 다르기때문에 이를 보면 어느 회사에서 만든 통신 제품인지 알 수 있다. 나머지 뒤쪽 6자리 값은 각 **장비**에 분배되는 `Host Identifier`다. **시리얼 넘버**라고 한다. 한 회사 내에서 각 장비를 구분하기 위해서 사용한다.

![image](https://user-images.githubusercontent.com/37951612/78267616-20fd8b80-7542-11ea-8115-787228a08673.png)
